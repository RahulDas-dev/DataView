import{u as e,a as t,b as r,g as a,P as i,d as n,j as o}from"./index-Be8Gr7j7.js";import{r as s}from"./ui-components-BNBUoXTo.js";import"./react-vendor-Bf-MSPTJ.js";import"./danfojs-bY-Wo8g9.js";import"./plotly-Dxrw3P6A.js";const l=({columnName:l,maxCategories:c=30})=>{const d=s.useRef(null),{isDark:m}=e(),{dataFrame:f}=t();return s.useEffect((()=>{if(!d.current||!f||f.isEmpty||0==f.shape[0]||!l)return;const e=d.current;e.innerHTML="";const t=r(m),o=f[l].dropNa();if(0===o.values.length)return void(e.innerHTML='<div class="p-4 text-zinc-500 dark:text-zinc-400 font-mono text-sm">No valid categorical data to display</div>');const s=o.valueCounts().sortValues({ascending:!1}),u=s.index.map((e=>String(e))),p=s.values,h=Math.min(u.length,c),x=u.length<c,g=u.slice(0,h),v=p.slice(0,h),b={labels:g,values:v,type:"pie",textinfo:"percent",textposition:"inside",automargin:!0,hoverinfo:"label+percent+name",textfont:{color:m?"rgba(0, 0, 0, 0.9)":"rgba(255, 255, 255, 0.9)",family:"monospace",size:11},marker:{colors:g.map(((e,r)=>x&&r===g.length-1?m?"rgba(82, 82, 91, 0.8)":"rgba(161, 161, 170, 0.8)":t.barGradient[r%t.barGradient.length])),line:{color:m?"#27272a":"#f8fafc",width:1.5}},pull:g.map((e=>"Other"===e?.05:0)),rotation:45},j={...a(m,e.offsetWidth),title:{text:`Distribution of ${l}`,font:{family:"'Montserrat', sans-serif",size:16},x:.05,xanchor:"left"},margin:{l:20,r:20,t:40,b:20},showlegend:!0,legend:{orientation:"v",x:1,y:.5,xanchor:"left",font:{family:"monospace",size:10},bgcolor:t.legendBackground,bordercolor:m?"rgba(255, 255, 255, 0.1)":"rgba(0, 0, 0, 0.1)",borderwidth:1}},w=n(`piechart_${l}`),y=()=>{e&&i.relayout(e,{width:e.offsetWidth})},z=setTimeout((()=>{try{e&&(i.newPlot(e,[b],j,w),window.addEventListener("resize",y))}catch(t){e&&(e.innerHTML='<div class="p-4 text-zinc-500 dark:text-zinc-400 font-mono text-sm">Error rendering pie chart</div>')}}),50);return()=>{if(clearTimeout(z),window.removeEventListener("resize",y),e)try{i.purge(e)}catch(t){}}}),[f,l,c,m]),o.jsx("div",{className:"w-full",children:o.jsx("div",{ref:d,className:"w-full h-[400px] min-h-[200px]","data-testid":"pie-chart",children:o.jsx("div",{className:"h-full w-full flex items-center justify-center",children:o.jsx("div",{className:"animate-pulse text-zinc-400 font-mono text-sm",children:"Loading visualization..."})})})})};export{l as default};
